<div class="now-button-container">
                <a href="#" id="claimBtn" class="now-button" data-track-event="ClaimNowClick" data-button-name="Claim Now Button" data-value="50.00" 
          data-currency="BDT">
                    <i class="fab fa-telegram"></i>
                    Claim Now
                </a>
        <p style="margin-top: 0.5rem; font-size: 0.75rem;">
            Trading involves risk. Past performance is not indicative of future results.
        </p>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
   <script>
        // --- Core Tracking Functions ---

        // Generates a unique event ID for deduplication.
        const generateUniqueEventId = () => 'evt_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

        // Retrieves the value of a specific cookie (_fbc, _fbp).
        const getCookie = (name) => {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            return parts.length === 2 ? parts.pop().split(';').shift() : null;
        };

        // Sends event data to the Vercel serverless function (for server-side tracking).
        async function sendEventToVercel(eventName, buttonName = null, uniqueEventId, eventValue = null, eventCurrency = null) { 
            const payload = {
                eventName, buttonName, pageUrl: window.location.href, eventId: uniqueEventId,
                fbc: getCookie('_fbc'), fbp: getCookie('_fbp'),
                value: eventValue, currency: eventCurrency // Include value and currency if provided
            };

            try {
                console.log(`Sending '${eventName}' event to Vercel API with ID: ${uniqueEventId}`);
                // !! IMPORTANT: Replace with your actual Vercel API URL !!
                const response = await fetch('https://rds-server-kamildex.vercel.app/api/track-event', { 
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload), credentials: 'include' // Required to send cookies
                });
                const data = await response.json();
                console.log(`Vercel Function Response for '${eventName}':`, data);
                if (!data.success) console.error('ERROR: Failed to send event via Vercel:', data.message);
            } catch (error) {
                console.error('ERROR: Error calling Vercel function:', error);
            }
        }

        // --- PageView Tracking Setup (Browser-Side & Server-Side Deduplicated) ---
const pageViewEventId = generateUniqueEventId();

window.addEventListener('load', () => {
  sendEventToVercel('PageView', null, pageViewEventId);
  fbq('track', 'PageView', { event_id: pageViewEventId });
  console.log(`Browser-side 'PageView' event sent with ID: ${pageViewEventId}`);
});
        // --- General Button Click Tracking Setup (using Event Delegation) ---
        // Attaches a single click listener to the entire document.
        // It detects clicks on elements with 'data-track-event' attribute.
        document.addEventListener('click', async (event) => {
            const targetElement = event.target.closest('[data-track-event]');

            if (targetElement) { // If a trackable element was clicked
                const eventName = targetElement.dataset.trackEvent; 
                const buttonName = targetElement.dataset.buttonName || targetElement.innerText || eventName; 
                
                // Extract value and currency from data attributes if present
                const eventValue = targetElement.dataset.value ? parseFloat(targetElement.dataset.value) : null;
                const eventCurrency = targetElement.dataset.currency || null;

                const uniqueEventId = generateUniqueEventId(); 

                // 1. Send Server-Side Event via Vercel Function
                await sendEventToVercel(eventName, buttonName, uniqueEventId, eventValue, eventCurrency);

                // 2. Send Browser-Side Pixel Event (for deduplication)
                // Conditionally include value and currency in custom_data
                const customData = {
                    button_name: buttonName,
                    event_id: uniqueEventId 
                };
                if (eventValue !== null) customData.value = eventValue;
                if (eventCurrency !== null) customData.currency = eventCurrency;

                fbq('track', eventName, customData);
                console.log(`Browser-side '${eventName}' event also sent with ID: ${uniqueEventId}`);
            }
        });
    
// --- General Button Click Tracking Setup (using Event Delegation) ---
// This listener handles all elements with 'data-track-event' attributes.
// It excludes 'claimBtn' as it has specific, separate handling.
document.addEventListener('click', async function (event) {
    const targetElement = event.target.closest('[data-track-event]');

    // Only process if it's a trackable element AND not the specific 'claimBtn'
    if (targetElement && targetElement.id !== 'claimBtn') {
        const eventName = targetElement.dataset.trackEvent;
        const buttonName = targetElement.dataset.buttonName || targetElement.innerText || eventName;

        const uniqueEventId = generateUniqueEventId();

        // 1. Send Server-Side Event via Vercel Function
        await sendEventToVercel(eventName, buttonName, uniqueEventId);

        // 2. Send Browser-Side Pixel Event (with the same event_id for deduplication)
        fbq('track', eventName, {
            button_name: buttonName,
            event_id: uniqueEventId
        });
        console.log(`Browser-side '${eventName}' event also sent with ID: ${uniqueEventId}`);
    }
});

// --- Specific Tracking & Logic for 'claimBtn' with SweetAlert2 and Auto Redirect ---
document.getElementById('claimBtn').addEventListener('click', function (event) {
    event.preventDefault(); // Prevent default link behavior

    // --- 1. ClaimNowClick Tracking Implementation ---
    const claimEventName = this.dataset.trackEvent;
    const claimButtonName = this.dataset.buttonName;
    const claimUniqueEventId = generateUniqueEventId();

    // Send Server-Side Event for ClaimNowClick
    sendEventToVercel(claimEventName, claimButtonName, claimUniqueEventId);
    console.log(`Server-side '${claimEventName}' event sent with ID: ${claimUniqueEventId}`);

    // Send Browser-Side Pixel Event for ClaimNowClick
    fbq('track', claimEventName, {
        button_name: claimButtonName,
        page_url: window.location.href,
        event_id: claimUniqueEventId
    });
    console.log(`Browser-side '${claimEventName}' event sent with ID: ${claimUniqueEventId}`);

    // Display SweetAlert2 popup
    Swal.fire({
        title: 'Congratulations!',
        html: 'You will be redirected to Telegram in <b></b> seconds.',
        icon: 'success',
        confirmButtonText: 'Go to Telegram',
        background: '#fff',
        color: '#333',
        confirmButtonColor: '#3085d6',
        allowOutsideClick: false,
        allowEscapeKey: false,
        timer: 3000,
        timerProgressBar: true,
        didOpen: () => {
            const b = Swal.getHtmlContainer().querySelector('b');
            let timerInterval = setInterval(() => {
                b.textContent = Math.ceil(Swal.getTimerLeft() / 1000);
            }, 100);
        },
        willClose: () => {
            clearInterval(this.timerInterval);
        }
    }).then((result) => {
        if (result.isConfirmed) {
            console.log('User clicked "Go to Telegram" button inside popup. Redirecting.');
            window.location.href = "https://t.me/+0RsurgoEtTFmZjll";
        } else if (result.dismiss === Swal.DismissReason.timer) {
            console.log('SweetAlert2 timer finished, auto-redirecting.');
        }
    });

    // --- 2. GoToJoin Tracking Implementation ---
    const goToEventName = 'GoToJoin';
    const goToButtonName = 'Telegram Auto Redirect Countdown Started';
    const goToUniqueEventId = generateUniqueEventId();

    sendEventToVercel(goToEventName, goToButtonName, goToUniqueEventId);
    console.log(`Server-side '${goToEventName}' event sent for auto-redirect with ID: ${goToUniqueEventId}`);

    fbq('track', goToEventName, {
        button_name: goToButtonName,
        page_url: window.location.href,
        event_id: goToUniqueEventId
    });
    console.log(`Browser-side '${goToEventName}' event sent for auto-redirect with ID: ${goToUniqueEventId}`);

    setTimeout(() => {
        window.location.href = "https://t.me/+0RsurgoEtTFmZjll";
    }, 3000);
});

    // Countdown timer
        const deadline = new Date("2025-07-11T00:00:00");

        function updateCountdown() {
            const now = new Date();
            const diff = deadline - now;
            const countdown = document.getElementById("countdown");

            if (!countdown) return;

            if (diff <= 0) {
                countdown.innerHTML = "<i class='fas fa-hourglass-end' style='margin-right:6px;'></i> Offer expired!";
                return;
            }

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const minutes = Math.floor((diff / (1000 * 60)) % 60);
            const seconds = Math.floor((diff / 1000) % 60);

            countdown.innerHTML =
                `<i class="fas fa-clock" style="margin-right: 6px;"></i> ${days}d ${hours}h ${minutes}m ${seconds}s left`;

            // Responsive font size
            if (window.innerWidth >= 992) {
                countdown.style.fontSize = "1.6rem"; // desktop size
            } else {
                countdown.style.fontSize = "1rem";   // mobile size
            }
        }

        updateCountdown();
        setInterval(updateCountdown, 1000);

        // On resize, adjust font size dynamically
        window.addEventListener('resize', updateCountdown);

    // --- Button ripple effect and pulse animation (consolidated) ---
    document.addEventListener('DOMContentLoaded', () => {
        const primaryBtn = document.querySelector('.btn-primary');
        const nowBtn = document.querySelector('.now-button'); // This is your #claimBtn

        // We already have a specific click listener for #claimBtn.
        // For .btn-primary, we will add the ripple effect without re-adding tracking.
        if (primaryBtn) {
            primaryBtn.addEventListener('click', function(e) {
                // The tracking for data-track-event elements is already handled by the general click listener.
                // This specific listener is only for the ripple effect.
                const rect = this.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const ripple = document.createElement('span');
                ripple.className = 'ripple';
                ripple.style.left = x + 'px';
                ripple.style.top = y + 'px';

                this.appendChild(ripple);

                setTimeout(() => {
                    ripple.remove();
                }, 1000);
            });
        }
        
        // Pulse animation for .btn-primary (if it's not the claimBtn, which often has its own styles)
        setInterval(() => {
            if (primaryBtn) { // Apply pulse to UPGRADE TO PREMIUM NOW button
                primaryBtn.style.transform = 'scale(1.02)';
                setTimeout(() => {
                    primaryBtn.style.transform = '';
                }, 300);
            }
        }, 3000);
    });

    // --- End of Consolidated JavaScript ---
    </script>